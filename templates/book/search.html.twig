{% extends 'base.html.twig' %}

{% block title %}Search Book{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1 class="mb-4">Search Book by Reference</h1>

    <form method="get" action="{{ path('app_book_search') }}" class="d-flex mb-3">
        <input type="text" name="ref" placeholder="Enter book ref"
               value="{{ ref|default('') }}"
               class="form-control me-2" style="max-width:200px;">
        <button type="submit" class="btn btn-primary">Search</button>
    </form>

    <hr>

    {% if book %}
        <div class="card shadow-sm p-3">
            <h2 class="mb-2">Result:</h2>
            <p><strong>Title:</strong> {{ book.title }}</p>
            <p><strong>Author:</strong> {{ book.author ? book.author.username : 'Unknown' }}</p>
            <p><strong>Category:</strong> {{ book.category }}</p>
            <p><strong>Publication Date:</strong> {{ book.publicationDate ? book.publicationDate|date('Y-m-d') : 'N/A' }}</p>
            <p><strong>Published:</strong> {{ book.published ? 'Yes' : 'No' }}</p>

            <div class="mt-3">
                <a href="{{ path('app_book_edit', {'ref': book.ref}) }}" class="btn btn-warning me-2">‚úèÔ∏è Edit</a>
                <form action="{{ path('app_book_delete', {'ref': book.ref}) }}" method="post" style="display:inline"
                      onsubmit="return confirm('Are you sure you want to delete this book?');">
                    <input type="hidden" name="_token" value="{{ csrf_token('delete-book-' ~ book.ref) }}">
                    <button type="submit" class="btn btn-danger">üóë Delete</button>
                </form>
            </div>
        </div>
    {% elseif ref is defined and ref %}
        <div class="alert alert-warning mt-3">
            No book found for reference "{{ ref }}"
        </div>
    {% endif %}
</div>
{% endblock %}
